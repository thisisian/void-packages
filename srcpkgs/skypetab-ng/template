# Template file for 'skypetab-ng'
pkgname=skypetab-ng
version=20150201
revision=2
build_style=qmake
_commit=9e5b1edf7b7f0c31cf47db429d5918367f12e0e8
hostmakedepends="pkg-config"
makedepends="libX11-devel qt-devel"
depends="skype libskypetab-ng-${version}_${revision}"
short_desc="A program that adds tabs to Skype for Linux"
maintainer="Juan RP <xtraeme@voidlinux.eu>"
homepage="http://keks-n.net/skypetab"
license="GPL-3"

only_for_archs=i686
lib32mode="full"
lib32depends="skype-32bit>=0 libskypetab-ng-${version}_${revision}"

wrksrc=skypetab-ng-$_commit
distfiles="https://github.com/kekekeks/skypetab-ng/archive/${_commit}.tar.gz"
checksum=aeab6dde5cfe3b85757ef79b2fc099b758c63c8eb1cfcfaaa17659a0667ba525

post_install() {
	chmod +x "${DESTDIR}/usr/share/applications/${pkgname}.desktop"
	sed -i -e "s|LD_PRELOAD=|LD_PRELOAD=/usr/lib32/|" \
		"${DESTDIR}/usr/bin/skypetab-ng"
}

libskypetab-ng_package() {
	short_desc+=" - shared LD_PRELOAD library"
	pkg_install() {
		vmove "usr/lib/*.so*"
	}
}
